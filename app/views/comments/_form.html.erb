<% comment ||= nil -%>
<% sha1 ||= nil -%>

<h3>Add a new comment:</h3>

<% if logged_in? -%>
  <%= error_messages_for :comment -%>
  <% form_for([@project, @repository, comment || Comment.new]) do |f| -%>
    <% if sha1 -%>
      <%= f.hidden_field :sha1, :value => sha1 -%>
    <% end -%>
    <p>
      <%= f.label :body, "Comment" -%><br />
      <%= f.text_area :body, :class => "text medium" -%>
    </p>
    <p>
      <%= f.submit "Add Comment" -%>
    </p>
  <% end -%>
<% else -%>
  <p>
    <em><%= link_to "Login", new_sessions_path -%> or 
    <%= link_to "create an account", new_user_path -%> to post a comment</em>
  </p>
<% end -%>