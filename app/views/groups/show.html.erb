<%
#--
#   Copyright (C) 2009 Johan SÃ¸rensen <johan@johansorensen.com>
#
#   This program is free software: you can redistribute it and/or modify
#   it under the terms of the GNU Affero General Public License as published by
#   the Free Software Foundation, either version 3 of the License, or
#   (at your option) any later version.
#
#   This program is distributed in the hope that it will be useful,
#   but WITHOUT ANY WARRANTY; without even the implied warranty of
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#   GNU Affero General Public License for more details.
#
#   You should have received a copy of the GNU Affero General Public License
#   along with this program.  If not, see <http://www.gnu.org/licenses/>.
#++
%>

<% content_for :submenu do -%>
  <%= render :partial => "site/breadcrumbs", :locals => {:root => @group} -%>
<% end -%>

<h1><%=h @group.name -%></h1>

<h3>Repositories (<%= @group.repositories.count -%>)</h3>
<ul class="repository_list">
  <% @group.repositories.each do |repository| -%>
    <li>
      <%= link_to(h(repository.project.title), project_path(repository.project)) -%>: 
      <%= link_to h(repository.name), group_repository_path(@group, repository) -%>
      <div class="hint page">
        <%= markdown(sanitize(repository.description)) -%>
      </div>
    </li>
  <% end -%>
</ul>

<h3>Team activity</h3>
<%= render :partial => "events/events", :locals => { :events => @events } -%>

<% content_for :sidebar do -%>
  <ul class="links">
    <% if @group.admin?(current_user) -%>
      <li><%= link_to t("views.groups.edit_memberships"), [@group, :memberships] -%></li>
    <% end -%>
  </ul>
  
  <h3>Members (<%= @group.members.count -%>)</h3>
  <ul class="repository_list">
    <% @group.members.each do |user| -%>
      <li>
        <div class="user">
          <%= gravatar(user.email, :size => 16, :style => "tiny") %>
          <%= link_to h(user.login), user_path(user) -%>
        </div>
      </li>
    <% end -%>
  </ul>
<% end -%>